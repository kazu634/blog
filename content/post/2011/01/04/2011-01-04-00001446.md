---
title: RedHat Enterprise Linux で OS 構築を自動化する
author: kazu634
date: 2011-01-04
wordtwit_post_info:
  - 'O:8:"stdClass":13:{s:6:"manual";b:0;s:11:"tweet_times";i:1;s:5:"delay";i:0;s:7:"enabled";i:1;s:10:"separation";s:2:"60";s:7:"version";s:3:"3.7";s:14:"tweet_template";b:0;s:6:"status";i:2;s:6:"result";a:0:{}s:13:"tweet_counter";i:2;s:13:"tweet_log_ids";a:1:{i:0;i:5407;}s:9:"hash_tags";a:0:{}s:8:"accounts";a:1:{i:0;s:7:"kazu634";}}'
categories:
  - linux

---
<div class="section">
<p>
    前回は Ubuntu の preseed を用いた場合を紹介しましたが、今回は RHEL の Kickstart を使用した場合を書きます。会社で色々とごにょごにょしてました。会社のプロキシの情報とかもあるので、NTPとかファイルサーバのマウントとかの処理ははしょって貼りつけておきますね。
</p>
  
<h4>
    前提条件
</h4>
  
<p>
    OS構築を自動化する前提条件は下記になります:
</p>
  
<ul>
<li>
      導入する OS は RHEL 5.4 (x64) であること(たぶんそれ以外のバージョンでも大丈夫のはず)
</li>
<li>
      OS を導入する環境から設定ファイルを格納するHTTPサーバ、もしくはNFSサーバに対して通信ができること
</li>
</ul>
  
<h4>
    構築するLinux環境
</h4>
  
<p>
    本手順を用いて構築する Linux 環境は以下になります:
</p>
  
<dl>
<dt>
      ホスト名
</dt>
    
<dd>
      test
</dd>
    
<dt>
      ネットワーク
</dt>
    
<dd>
      eth0 に対して DHCP でネットワーク設定を行う
</dd>
    
<dt>
      root のパスワード
</dt>
    
<dd>
      testserver
</dd>
    
<dt>
      Firewall
</dt>
    
<dd>
      オフ
</dd>
    
<dt>
      selinux
</dt>
    
<dd>
      使用しない
</dd>
    
<dt>
      ディスク
</dt>
    
<dd>
      ディスク全体を初期化し、 LVM とする
</dd>
</dl>
  
<h4>
    設定ファイル
</h4>
  
<p>
    下記の設定ファイルをNFSサーバ or HTTP サーバなどに設置します。
</p>
  
<pre class="syntax-highlight">
<span class="synComment"># Kickstart file automatically generated by anaconda.</span>
text
install
cdrom
key --skip
lang ja_JP.UTF-8
keyboard jp106
network --device eth0 --bootproto dhcp --hostname test
rootpw testserver
firewall --disabled
authconfig --enableshadow --enablemd5
selinux --disabled
timezone --utc Asia/Tokyo
bootloader --location=mbr --driveorder=sda --append=<span class="synConstant">&#34;rhgb quiet&#34;</span>
services --enabled=ntpd
<span class="synComment"># The following is the partition information you requested</span>
<span class="synComment"># Note that any partitions you deleted are not expressed</span>
<span class="synComment"># here so unless you clear all partitions first, this is</span>
<span class="synComment"># not guaranteed to work</span>
clearpart --all --drives=sda --initlabel
part /boot --fstype ext3 --size=100 --ondisk=sda
part pv.6 --size=0 --grow --ondisk=sda
volgroup VolGroup00 --pesize=32768 pv.6
logvol / --fstype ext3 --name=LogVol00 --vgname=VolGroup00 --size=1024 --grow
logvol swap --fstype swap --name=LogVol01 --vgname=VolGroup00 --size=384 --grow --maxsize=768
%packages
@base
@core
@development-libs
@development-tools
</pre>
  
<h4>
    手順
</h4>
  
<p>
    インストーラーの画面が表示されたら、以下のようにコマンドをタイプし、エンターキーを押してください:
</p>
  
<blockquote>
<p>
      linux ks=nfs:NFSサーバのIPアドレス:設定ファイルへのパス
</p>
</blockquote>
  
<p>
    もしくは、以下のように設定ファイルへの URL を指定しても大丈夫です。
</p>
  
<blockquote>
<p>
      linux ks=http://サーバのIPアドレス/設定ファイルへのURL
</p>
</blockquote>
  
<p>
    ※: インストーラーの画面上ではキーボード配列が ASCII 配列と認識されています。そのため「:」は「SHIFT + ;」を、「=」は「^」で入力してください。
</p>
  
<p>
    基本的には自動で Linux の構築が行われます。インストール媒体を取り替える場合だけ手動で作業を行う必要があります。画面の指示に従って、インストール媒体を取り替えてください。
</p>
  
<div class="hatena-asin-detail">
<a href="http://www.amazon.co.jp/dp/B004EBH770/?tag=hatena_st1-22&ascsubtag=d-7ibv" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.amazon.co.jp/dp/B004EBH770/?tag=hatena_st1-22&ascsubtag=d-7ibv', '');"><img src="https://images-na.ssl-images-amazon.com/images/I/51XDK5%2BuuHL._SL160_.jpg" class="hatena-asin-detail-image" alt="Software Design (ソフトウェア デザイン) 2011年 01月号 [雑誌]" title="Software Design (ソフトウェア デザイン) 2011年 01月号 [雑誌]" /></a></p> 
    
<div class="hatena-asin-detail-info">
<p class="hatena-asin-detail-title">
<a href="http://www.amazon.co.jp/dp/B004EBH770/?tag=hatena_st1-22&ascsubtag=d-7ibv" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.amazon.co.jp/dp/B004EBH770/?tag=hatena_st1-22&ascsubtag=d-7ibv', 'Software Design (ソフトウェア デザイン) 2011年 01月号 [雑誌]');">Software Design (ソフトウェア デザイン) 2011年 01月号 [雑誌]</a>
</p>
      
<ul>
<li>
<span class="hatena-asin-detail-label">出版社/メーカー:</span> <a href="http://d.hatena.ne.jp/keyword/%B5%BB%BD%D1%C9%BE%CF%C0%BC%D2" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://d.hatena.ne.jp/keyword/%B5%BB%BD%D1%C9%BE%CF%C0%BC%D2', '技術評論社');" class="keyword">技術評論社</a>
</li>
<li>
<span class="hatena-asin-detail-label">発売日:</span> 2010/12/18
</li>
<li>
<span class="hatena-asin-detail-label">メディア:</span> 雑誌
</li>
<li>
<span class="hatena-asin-detail-label">購入</span>: 2人 <span class="hatena-asin-detail-label">クリック</span>: 26回
</li>
<li>
<a href="http://d.hatena.ne.jp/asin/B004EBH770" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://d.hatena.ne.jp/asin/B004EBH770', 'この商品を含むブログ (249件) を見る');" target="_blank">この商品を含むブログ (249件) を見る</a>
</li>
</ul>
</div>
    
<div class="hatena-asin-detail-foot">
</div>
</div>
</div>
