---
title: Debian自宅サーバ、SSHが使えるようになった
author: kazu634
date: 2008-12-29
url: /2008/12/29/_1186/
wordtwit_post_info:
  - 'O:8:"stdClass":13:{s:6:"manual";b:0;s:11:"tweet_times";i:1;s:5:"delay";i:0;s:7:"enabled";i:1;s:10:"separation";s:2:"60";s:7:"version";s:3:"3.7";s:14:"tweet_template";b:0;s:6:"status";i:2;s:6:"result";a:0:{}s:13:"tweet_counter";i:2;s:13:"tweet_log_ids";a:1:{i:0;i:4469;}s:9:"hash_tags";a:0:{}s:8:"accounts";a:1:{i:0;s:7:"kazu634";}}'
categories:
  - つれづれ

---
<div class="section">
<p>
    「<a href="http://d.hatena.ne.jp/sirocco634/20081227/1230386205" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://d.hatena.ne.jp/sirocco634/20081227/1230386205', ' 自宅サーバを設置しようとしています &#8211; 武蔵の日記');" target="_blank"> 自宅サーバを設置しようとしています &#8211; 武蔵の日記</a>」の続きです。ようやくsshが使えるようになりました。
</p>
  
<h4>
    ネットワーク
</h4>
  
<p>
    なぜか初期のインストールではDHCPでの設定がうまくいかず。手動でもネットワークに繋がらないので、仕方がなくネットワークからダウンロードせずに最小構成でセットアップを終了。Debianを起動させてDHCPを認識させるための設定を書いてみる。/etc/network/interfacesを編集。
</p>
  
<pre class="syntax-highlight">
<span class="synComment"># This file describes the network interfaces available on your system</span>
<span class="synComment"># and how to activate them. For more information, see interfaces(5).</span>
<span class="synComment"># The loopback network interface</span>
auto lo
iface lo inet loopback
<span class="synComment"># The primary network interface</span>
allow-hotplug eth0
iface eth0 inet dhcp
</pre>
  
<p>
    これをやると、DHCPで認識する。なんでなんだろう？
</p>
  
<p>
    でも、この最小構成の状態だと色々と不都合かなと感じたので、もう一度インストールを試みる。今度は一発でDHCP認識できた。たぶん、上書きインストールの際には前の設定ファイルを読み込んでいるのだろうと推測。とりあえずできたからいいや。
</p>
  
<h4>
    aptitudeの設定
</h4>
  
<p>
    パッケージ管理のためにaptitudeを最新の状態にしたよ。まずは/etc/apt/source.listを編集して、deb cdromで始まる行を削除するか、コメントアウトする。
</p>
  
<pre class="syntax-highlight">
<span class="synComment"># deb cdrom:[Debian GNU/Linux 4.0 r6 _Etch_ - Official i386 NETINST Binary-1 20081220-23:12]/ etch contrib main</span>
</pre>
  
<p>
    そうしてから
</p>
  
<pre class="syntax-highlight">
<span class="synComment"># aptitude update</span>
<span class="synComment"># aptitude upgrade</span>
</pre>
  
<p>
    する。
</p>
  
<h4>
    sudoの導入
</h4>
  
<p>
    無いと色々と不便だから、導入するよ。
</p>
  
<pre class="syntax-highlight">
<span class="synComment"># aptitude -y install sudo</span>
<span class="synComment"># visudo</span>
</pre>
  
<p>
    visudoしてsudoersを編集するよ。自分の場合はこうなった
</p>
  
<pre class="syntax-highlight">
kazu634 ALL=(ALL) ALL
</pre>
  
<p>
    を追加した。
</p>
  
<h4>
    vsftpdの導入
</h4>
  
<p>
    sshを導入するためには、ファイルのやりとりをしなければいけないのでftpサーバをまず最初にたてる。
</p>
  
<pre class="syntax-highlight">
<span class="synComment"># aptitude -y install vsftpd</span>
<span class="synComment"># vi /etc/vsftpd.conf</span>
</pre>
  
<p>
    このvsftpd.confは次のように設定。
</p>
  
<ul>
<li>
      anonymous_enable=no
</li>
<li>
      local_enable=yes
</li>
<li>
      write_enable=yes
</li>
<li>
      chroot_local_user=yes
</li>
</ul>
  
<p>
    設定が終わったら、vsftpdを再起動する。
</p>
  
<pre class="syntax-highlight">
<span class="synComment"># /etc/init.d/vsftpd restart</span>
</pre>
  
<h4>
    sshの導入
</h4>
  
<p>
    sshをやっと導入するよ。
</p>
  
<pre class="syntax-highlight">
<span class="synComment"># aptitude -y install openssh-client openssh-server</span>
<span class="synComment"># vi /etc/ssh/sshd_config</span>
</pre>
  
<p>
    sshd_configは次のように変更した。
</p>
  
<ul>
<li>
      PermitRootLogin no
</li>
<li>
      PasswordAuthentication no
</li>
</ul>
  
<p>
    これで一通りの設定はできたよ。後は鍵を交換すればOK。ここでは触れません。
</p>
  
<div class="hatena-asin-detail">
<a href="http://www.amazon.co.jp/dp/4798020257/?tag=hatena_st1-22&ascsubtag=d-7ibv" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.amazon.co.jp/dp/4798020257/?tag=hatena_st1-22&ascsubtag=d-7ibv', '');"><img src="https://images-na.ssl-images-amazon.com/images/I/51XC77-shCL._SL160_.jpg" class="hatena-asin-detail-image" alt="実践Debian GNU/Linuxサーバ ルート養成講座" title="実践Debian GNU/Linuxサーバ ルート養成講座" /></a></p> 
    
<div class="hatena-asin-detail-info">
<p class="hatena-asin-detail-title">
<a href="http://www.amazon.co.jp/dp/4798020257/?tag=hatena_st1-22&ascsubtag=d-7ibv" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.amazon.co.jp/dp/4798020257/?tag=hatena_st1-22&ascsubtag=d-7ibv', '実践Debian GNU/Linuxサーバ ルート養成講座');">実践Debian GNU/Linuxサーバ ルート養成講座</a>
</p>
      
<ul>
<li>
<span class="hatena-asin-detail-label">作者:</span> <a href="http://d.hatena.ne.jp/keyword/%C5%C4%B7%AD%B5%FD" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://d.hatena.ne.jp/keyword/%C5%C4%B7%AD%B5%FD', '田鍬享');" class="keyword">田鍬享</a>
</li>
<li>
<span class="hatena-asin-detail-label">出版社/メーカー:</span> <a href="http://d.hatena.ne.jp/keyword/%BD%A8%CF%C2%A5%B7%A5%B9%A5%C6%A5%E0" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://d.hatena.ne.jp/keyword/%BD%A8%CF%C2%A5%B7%A5%B9%A5%C6%A5%E0', '秀和システム');" class="keyword">秀和システム</a>
</li>
<li>
<span class="hatena-asin-detail-label">発売日:</span> 2008/07
</li>
<li>
<span class="hatena-asin-detail-label">メディア:</span> 単行本
</li>
<li>
<span class="hatena-asin-detail-label">クリック</span>: 56回
</li>
<li>
<a href="http://d.hatena.ne.jp/asin/4798020257" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://d.hatena.ne.jp/asin/4798020257', 'この商品を含むブログ (4件) を見る');" target="_blank">この商品を含むブログ (4件) を見る</a>
</li>
</ul>
</div>
    
<div class="hatena-asin-detail-foot">
</div>
</div>
</div>
