---
title: ubuntu サーバで vyatta の SNMP 情報を取得する
author: kazu634
date: 2012-09-17
wordtwit_post_info:
  - 'O:8:"stdClass":13:{s:6:"manual";b:0;s:11:"tweet_times";s:1:"1";s:5:"delay";s:1:"0";s:7:"enabled";s:1:"1";s:10:"separation";i:60;s:7:"version";s:3:"3.7";s:14:"tweet_template";b:0;s:6:"status";i:2;s:6:"result";a:0:{}s:13:"tweet_counter";i:2;s:13:"tweet_log_ids";a:1:{i:0;i:5469;}s:9:"hash_tags";a:0:{}s:8:"accounts";a:1:{i:0;s:7:"kazu634";}}'
categories:
  - snmp
  - ubuntu
  - vyatta

---
<div class="section">
<p>
    まとめの時間が取れていませんが、こつこつと ESXi サーバのテストをしています。タイムリーにはまったので、切り出して書きます。
</p>
  
<h4>
    やりたいこと
</h4>
  
<p>
    ubuntuサーバを監視用に利用するつもりで、 SNMP Get で vyatta の情報を取得したい。
</p>
  
<h4>
    ubuntuサーバで必要なこと
</h4>
  
<p>
    必要なパッケージをインストールします:
</p>
  
<pre class="syntax-highlight">
$ sudo aptitude <span class="synStatement">install</span> snmp snmp-mibs-downloader
</pre>
  
<p>
    /etc/snmp/snmp.conf を編集します:
</p>
  
<pre class="syntax-highlight">
$ sudo cp -p /etc/snmp/snmp.conf /etc/snmp/snmp.conf.`date "+%Y%m%d"`
$ ll /etc/snmp/snmp.conf*
$ sudo vi /etc/snmp/snmp.conf
$ diff -u /etc/snmp/snmp.conf.`date "+%Y%m%d"` /etc/snmp/snmp.conf
</pre>
  
<h4>
    vyatta で必要なこと
</h4>
  
<p>
    コミュニティ名を指定してあげます。
</p>
  
<pre class="syntax-highlight">
$ configure
# set service snmp community vm-env
# commit
# save
# exit
</pre>
  
<h4>
    動作確認
</h4>
  
<p>
    ubuntuサーバから vyatta (192.168.1.1) にアクセスして snmp get します。
</p>
  
<pre class="syntax-highlight">
% snmpwalk <span class="synSpecial">-v2c</span> <span class="synSpecial">-c</span> vm-env <span class="synConstant">192</span>.<span class="synConstant">168</span>.<span class="synConstant">1</span>.<span class="synConstant">1</span> <span class="synStatement">|</span> head                                               <span class="synStatement">[</span>/etc/init.d<span class="synStatement">]</span>
SNMPv2-MIB::sysDescr.<span class="synConstant"></span> <span class="synStatement">=</span> STRING: Vyatta VC6.<span class="synConstant">4-2012</span>.<span class="synConstant">05</span>.<span class="synConstant">31</span>
SNMPv2-MIB::sysObjectID.<span class="synConstant"></span> <span class="synStatement">=</span> OID: SNMPv2-SMI::enterprises.<span class="synConstant">30803</span>
DISMAN-EVENT-MIB::sysUpTimeInstance <span class="synStatement">=</span> Timeticks: <span class="synStatement">(</span><span class="synConstant">4298156</span><span class="synStatement">)</span> <span class="synConstant">11</span>:<span class="synConstant">56</span>:<span class="synConstant">21</span>.<span class="synConstant">56</span>
SNMPv2-MIB::sysContact.<span class="synConstant"></span> <span class="synStatement">=</span> STRING: root
SNMPv2-MIB::sysName.<span class="synConstant"></span> <span class="synStatement">=</span> STRING: vyatta
SNMPv2-MIB::sysLocation.<span class="synConstant"></span> <span class="synStatement">=</span> STRING: Unknown
SNMPv2-MIB::sysServices.<span class="synConstant"></span> <span class="synStatement">=</span> INTEGER: <span class="synConstant">14</span>
SNMPv2-MIB::sysORLastChange.<span class="synConstant"></span> <span class="synStatement">=</span> Timeticks: <span class="synStatement">(</span><span class="synConstant">4</span><span class="synStatement">)</span> <span class="synConstant"></span>:<span class="synConstant">00</span>:<span class="synConstant">00</span>.<span class="synConstant">04</span>
SNMPv2-MIB::sysORID.<span class="synConstant">1</span> <span class="synStatement">=</span> OID: SNMP-MPD-MIB::snmpMPDMIBObjects.<span class="synConstant">3</span>.<span class="synConstant">1</span>.<span class="synConstant">1</span>
SNMPv2-MIB::sysORID.<span class="synConstant">2</span> <span class="synStatement">=</span> OID: SNMP-USER-BASED-SM-MIB::usmMIBCompliance
</pre>
  
<div class="hatena-asin-detail">
<a href="http://www.amazon.co.jp/dp/4774147117/?tag=hatena_st1-22&ascsubtag=d-7ibv" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.amazon.co.jp/dp/4774147117/?tag=hatena_st1-22&ascsubtag=d-7ibv', '');"><img src="https://images-na.ssl-images-amazon.com/images/I/51djw5HzjLL._SL160_.jpg" class="hatena-asin-detail-image" alt="オープンソース・ソフトウェアルータVyatta入門　――実践ルーティングから仮想化まで (Software Design plus)" title="オープンソース・ソフトウェアルータVyatta入門　――実践ルーティングから仮想化まで (Software Design plus)" /></a></p> 
    
<div class="hatena-asin-detail-info">
<p class="hatena-asin-detail-title">
<a href="http://www.amazon.co.jp/dp/4774147117/?tag=hatena_st1-22&ascsubtag=d-7ibv" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.amazon.co.jp/dp/4774147117/?tag=hatena_st1-22&ascsubtag=d-7ibv', 'オープンソース・ソフトウェアルータVyatta入門　――実践ルーティングから仮想化まで (Software Design plus)');">オープンソース・ソフトウェアルータVyatta入門　――実践ルーティングから仮想化まで (Software Design plus)</a>
</p>
      
<ul>
<li>
<span class="hatena-asin-detail-label">作者:</span> <a href="http://d.hatena.ne.jp/keyword/%B6%E1%C6%A3%CB%AE%BE%BC" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://d.hatena.ne.jp/keyword/%B6%E1%C6%A3%CB%AE%BE%BC', '近藤邦昭');" class="keyword">近藤邦昭</a>,<a href="http://d.hatena.ne.jp/keyword/%BE%BE%CB%DC%C4%BE%BF%CD" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://d.hatena.ne.jp/keyword/%BE%BE%CB%DC%C4%BE%BF%CD', '松本直人');" class="keyword">松本直人</a>,<a href="http://d.hatena.ne.jp/keyword/%C0%F5%B4%D6%C0%B5%CF%C2" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://d.hatena.ne.jp/keyword/%C0%F5%B4%D6%C0%B5%CF%C2', '浅間正和');" class="keyword">浅間正和</a>,<a href="http://d.hatena.ne.jp/keyword/%C2%E7%B5%D7%CA%DD%BD%A4%B0%EC" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://d.hatena.ne.jp/keyword/%C2%E7%B5%D7%CA%DD%BD%A4%B0%EC', '大久保修一');" class="keyword">大久保修一</a>,<a href="http://d.hatena.ne.jp/keyword/%C6%FC%CB%DCVyatta%A5%E6%A1%BC%A5%B6%A1%BC%B2%F1" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://d.hatena.ne.jp/keyword/%C6%FC%CB%DCVyatta%A5%E6%A1%BC%A5%B6%A1%BC%B2%F1', '日本Vyattaユーザー会');" class="keyword">日本Vyattaユーザー会</a>
</li>
<li>
<span class="hatena-asin-detail-label">出版社/メーカー:</span> <a href="http://d.hatena.ne.jp/keyword/%B5%BB%BD%D1%C9%BE%CF%C0%BC%D2" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://d.hatena.ne.jp/keyword/%B5%BB%BD%D1%C9%BE%CF%C0%BC%D2', '技術評論社');" class="keyword">技術評論社</a>
</li>
<li>
<span class="hatena-asin-detail-label">発売日:</span> 2011/06/16
</li>
<li>
<span class="hatena-asin-detail-label">メディア:</span> 大型本
</li>
<li>
<span class="hatena-asin-detail-label">購入</span>: 1人 <span class="hatena-asin-detail-label">クリック</span>: 33回
</li>
<li>
<a href="http://d.hatena.ne.jp/asin/4774147117" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://d.hatena.ne.jp/asin/4774147117', 'この商品を含むブログ (7件) を見る');" target="_blank">この商品を含むブログ (7件) を見る</a>
</li>
</ul>
</div>
    
<div class="hatena-asin-detail-foot">
</div>
</div>
</div>
