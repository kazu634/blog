---
title: Snow Leopard で nfs マウントをする
author: kazu634
date: 2010-01-06
wordtwit_post_info:
  - 'O:8:"stdClass":13:{s:6:"manual";b:0;s:11:"tweet_times";i:1;s:5:"delay";i:0;s:7:"enabled";i:1;s:10:"separation";s:2:"60";s:7:"version";s:3:"3.7";s:14:"tweet_template";b:0;s:6:"status";i:2;s:6:"result";a:0:{}s:13:"tweet_counter";i:2;s:13:"tweet_log_ids";a:1:{i:0;i:5045;}s:9:"hash_tags";a:0:{}s:8:"accounts";a:1:{i:0;s:7:"kazu634";}}'
categories:
  - Mac

---
<div class="section">
<h4>
    はじめに
</h4>
  
<p>
    Snow Leopardでnfsマウントしようとしたら詰まったので、ここに手順を書いておきます。nfsについては<a href="http://ja.wikipedia.org/wiki/Network_File_System" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://ja.wikipedia.org/wiki/Network_File_System', 'Network File System &#8211; Wikipedia');" target="_blank">Network File System &#8211; Wikipedia</a>を参考にしてください。
</p>
  
<h4>
    nfsサーバー側の設定
</h4>
  
<p>
    ネットワーク構成はこのような感じです:
</p>
  
<p>
<center>
</center>
</p>
  
<p>
<a href="http://flickr.com/photos/42332031@N02/4250463975/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://flickr.com/photos/42332031@N02/4250463975/', '');" title="ネットワーク構成"><img src="http://farm5.static.flickr.com/4028/4250463975_1026f0b1df.jpg" /></a>
</p></p> 
  
<p>
    nfsサーバーの設定は「<a href="http://itmst.blog71.fc2.com/blog-entry-89.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://itmst.blog71.fc2.com/blog-entry-89.html', 'Electronic Genome &#8211; Ubuntu + NFSサーバでファイル共有');" target="_blank">Electronic Genome &#8211; Ubuntu + NFSサーバでファイル共有</a>」を見て実施しました。結果的には、
</p>
  
<ol>
<li>
      パッケージのインストール
</li>
<li>
      /etc/exports の設定
</li>
<li>
      /etc/exports の設定の反映
</li>
</ol>
  
<p>
    を実施すれば大丈夫でした。
</p>
  
<h4>
    NFSクライアント(Snow Leopard)側の設定
</h4>
  
<p>
    NFSサーバ側は特に問題がなかったのですが、クライアント側では問題がありました。
</p>
  
<p>
    そこで検索をしてみると、「<a href="http://mount-q.com/yamaqblog/?p=1018" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://mount-q.com/yamaqblog/?p=1018', 'yamaq blog &#187; OSXからLinuxのnfsマウント');" target="_blank">yamaq blog &#187; OSXからLinuxのnfsマウント</a>」を発見しました:
</p>
  
<blockquote title="【コラム】OS X ハッキング! %2814%29 OS XでNFSを利用する%282%29 | パソコン | マイコミジャーナル" cite="http://journal.mycom.co.jp/column/osx/014/index.html">
<p>
      まずは前回の補足から。Finderの「サーバへ接続」ウィンドウからNFS領域をマウントする方法を紹介したが、LinuxやSolarisなど他のUNIX系OSで公開されているNFS領域をマウントできないことがある。Linuxを例にすると、最近のLinuxディストリビューションの多くが1024番以下の特権ポートをNFSのデフォルトとしているため、1024番以上のポートを使うようにマウントしなければならないからだ。
</p>
    
<p>
<cite><a href="http://journal.mycom.co.jp/column/osx/014/index.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://journal.mycom.co.jp/column/osx/014/index.html', '【コラム】OS X ハッキング! %2814%29 OS XでNFSを利用する%282%29 | パソコン | マイコミジャーナル');" target="_blank">【コラム】OS X ハッキング! %2814%29 OS XでNFSを利用する%282%29 | パソコン | マイコミジャーナル</a></cite>
</p>
</blockquote>
  
<p>
    これが原因で、nfsのマウントに失敗していました（ここも参考になりました: 「<a href="http://pasopia.cocolog-nifty.com/blog/2007/06/mac_os_nfs_moun_cfb6.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://pasopia.cocolog-nifty.com/blog/2007/06/mac_os_nfs_moun_cfb6.html', '聖アンドレアスの失敗: Mac OS から NFS mount する');" target="_blank">聖アンドレアスの失敗: Mac OS から NFS mount する</a>」）。
</p>
  
<p>
    回避するには、
</p>
  
<blockquote title="【コラム】OS X ハッキング! %2814%29 OS XでNFSを利用する%282%29 | パソコン | マイコミジャーナル" cite="http://journal.mycom.co.jp/column/osx/014/index.html">
<p>
      % sudo mount_nfs -P linux:/mnt/cdrom /tmp
</p>
    
<p>
<cite><a href="http://journal.mycom.co.jp/column/osx/014/index.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://journal.mycom.co.jp/column/osx/014/index.html', '【コラム】OS X ハッキング! %2814%29 OS XでNFSを利用する%282%29 | パソコン | マイコミジャーナル');" target="_blank">【コラム】OS X ハッキング! %2814%29 OS XでNFSを利用する%282%29 | パソコン | マイコミジャーナル</a></cite>
</p>
</blockquote>
  
<p>
    mount_nfsコマンドをpオプションで実行すればよいというものでした。これでマウントできたぞ。
</p>
  
<h4>
    起動時に自動でマウントする方法
</h4>
  
<p>
    当初私は、「<a href="http://dmsolutions.jp/wp/2009/10/17/snow-leopard-%E3%81%A7-%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AF%E3%83%A6%E3%83%BC%E3%83%86%E3%82%A3%E3%83%AA%E3%83%86%E3%82%A3%E3%82%92%E4%BD%BF%E3%82%8F%E3%81%9A%E3%81%AB%E3%81%86%E3%81%BE%E3%81%8F-nfs/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://dmsolutions.jp/wp/2009/10/17/snow-leopard-%E3%81%A7-%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AF%E3%83%A6%E3%83%BC%E3%83%86%E3%82%A3%E3%83%AA%E3%83%86%E3%82%A3%E3%82%92%E4%BD%BF%E3%82%8F%E3%81%9A%E3%81%AB%E3%81%86%E3%81%BE%E3%81%8F-nfs/', 'Snow Leopard で ディスクユーティリティを使わずにうまく NFS マウントする方法');" target="_blank">Snow Leopard で ディスクユーティリティを使わずにうまく NFS マウントする方法</a>」を参考にしたのですが、うまくいきませんでした。
</p>
  
<p>
    おそらく自動起動時のマウントコマンドはpオプションをつけていないことが問題だと思って検索してみました。すると発見！
</p>
  
<blockquote title="Jeff’s Place &#187; Blog Archive &#187; Mac OS-X Server as a NIS Client with Automount" cite="http://www.jeff.com/2009/mac-os-x-server-as-a-nis-client-with-automount/">
<p>
      Most NFS servers require mount requests to come from “secure” ports (ports <1024) but it appears the Mac NFS client does not adhere to this by default. So, to fix this edit /etc/autofs.conf and add “resvport” to the options line:
</p>
    
<p>
</p>
    
<p>
      AUTOMOUNTD_MNTOPTS=nosuid,nodev,resvport
</p>
    
<p>
</p>
    
<p>
      Note you have to be root to edit that file.
</p>
    
<p>
<cite><a href="http://www.jeff.com/2009/mac-os-x-server-as-a-nis-client-with-automount/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.jeff.com/2009/mac-os-x-server-as-a-nis-client-with-automount/', 'Jeff’s Place &#187; Blog Archive &#187; Mac OS-X Server as a NIS Client with Automount');" target="_blank">Jeff’s Place &#187; Blog Archive &#187; Mac OS-X Server as a NIS Client with Automount</a></cite>
</p>
</blockquote>
  
<p>
    結局、下記のように
</p>
  
<ul>
<li>
      /etc/autofs.conf
</li>
<li>
      /etc/auto_master
</li>
</ul>
  
<p>
    を編集すると自動で/net配下にマウントされ、finder上で表示されるようになりました:
</p>
  
<pre class="syntax-highlight">
kazu634@kazu634% diff /etc/auto_master.20091225bk /etc/auto_master                          ~ <span class="synStatement">[</span><span class="synConstant">920</span><span class="synStatement">]</span>
5c5
<span class="synStatement">&#60;</span> /net                  <span class="synSpecial">-hosts</span>          <span class="synSpecial">-nobrowse</span>,hidefromfinder,nosuid
---
<span class="synStatement">&#62;</span> /net                  <span class="synSpecial">-hosts</span>          <span class="synSpecial">-nosuid</span>,nolocks,locallocks
kazu634@kazu634% diff /etc/autofs.conf.20100106bk /etc/autofs.conf                          ~ <span class="synStatement">[</span><span class="synConstant">919</span><span class="synStatement">]</span>
39c39
<span class="synStatement">&#60;</span> <span class="synIdentifier">AUTOMOUNTD_MNTOPTS</span>=nosuid,nodev
---
<span class="synStatement">&#62;</span> <span class="synIdentifier">AUTOMOUNTD_MNTOPTS</span>=nosuid,nodev,resvport
</pre>
  
<h4>
    結果
</h4>
  
<p>
<center>
</center>
</p>
  
<p>
<a href="http://flickr.com/photos/42332031@N02/4250499039/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://flickr.com/photos/42332031@N02/4250499039/', '');" title="Finderでnfsのマウントポイントを開く"><img src="http://farm3.static.flickr.com/2702/4250499039_444e298290.jpg" /></a>
</p></p>
</div>
